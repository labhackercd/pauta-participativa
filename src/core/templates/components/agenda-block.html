{% load pauta_participativa_tags staticfiles %}
{% randomize_queryset object.groups.all as groups %}
<div class="agenda-block JS-agenda" data-agenda-id="{{object.id}}">

  {% if not user.is_authenticated %}
    <p>Você precisa estar logado no sistema para votar.</p>
  {% endif %}

  <div class="interaction-block">
    {% for group in groups %}
      {% include "components/group-block.html" with groups=group last_group=groups|last first_group=groups|first %}
    {% endfor %}

    {% if user.is_authenticated %}
      <div class="group-block -review JS-votes-review JS-group" data-group-id="finish">
        <div class="wrapper">

         <div class="note-message">
           <p class="text">Confira os seus votos.</p>
           <p class="text">Depois de enviar, eles não poderão ser alterados!</p>
         </div>

          {% for group in groups %}
            {% include "components/review-card.html" with group=group %}
          {% endfor %}

          <form action="" class="submit JS-confirm-votes">
            {% csrf_token %}
            <div class="g-recaptcha" data-sitekey="{% recaptcha_site_key %}"></div>
            <button class="button JS-submit-votes-btn">Enviar</button>
          </form>
        </div>
      </div>
    {% endif %}
  </div>

  <div class="theme-navigation JS-theme-navigation">
    <nav class="JS-tab-navigation">
      {% for group in groups %}
        {% with groups|first as first_group %}
          <a class="-{{group.theme.slug}} {% if group == first_group %}-active{% endif %} JS-tab-item" data-group-id="{{group.id}}">
            {{group.theme.name}}
          </a>
        {% endwith %}
      {% endfor %}
      <a class="item JS-tab-item" data-group-id="finish">
        Finalizar
      </a>
    </nav>
  </div>

  <div class="error-message JS-error-message">
    <p>Para retirar um projeto da pauta, você precisa incluir outros dois.</p>
    <a class="close JS-error-close"></a>
  </div>

</div>