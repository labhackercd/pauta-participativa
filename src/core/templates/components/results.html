{% load pauta_participativa_tags %}

<div class="result-page">

  <div class="wrapper">

    {% if not object.is_closed %}
      <div class="note-message">
        <p class="text">Obrigada por participar!</p>
        <p class="text">Compartilhe com seus amigos:</p>
      </div>
    {% else %}
      <h2 class="title">Resultado</h2>
    {% endif %}

    <div class="share">
      <a class="link -facebook JS-share-lnk" data-social="facebook" title="Facebook"></a>
      <a class="link -twitter JS-share-lnk" data-social="twitter" title="Twitter"></a>
      <a class="link -whatsapp JS-share-lnk" data-social="whatsapp" title="Whatsapp"></a>
    </div>

    <div class="note-message">
      <p class="text">Veja abaixo o resultado parcial:</p>
    </div>

    {% maximum_votes object as max_votes %}
    {% for group in object.groups.all %}
      <div class="theme-card">
        <h3 class="title -{{group.theme.slug}}">{{group.theme.name}}</h3>
        <ul>
          {% ordered_proposals group as proposals %}
          {% for proposal in proposals %}
            <li class="proposal-result">
              <div class="info">
                <h4 class="title">{{proposal.title}}</h4>
                <p class="pl">{{proposal.proposal_type.initials}} {{proposal.number}}/{{proposal.year}}</p>
              </div>
              <div class="stats">
                <div class="graph">
                  <div class="label -against">{{proposal|downvotes:group}}</div>
                  <div class="bars">
                    <div class="balance" style="left: {% score_percentage proposal group max_votes %}%;"></div>
                    <div class="bar">
                      <div class="fill -against" style="width: {% downvote_percentage proposal group max_votes %}%"></div>
                    </div>
                    <div class="bar">
                      <div class="fill -infavor" style="width: {% upvote_percentage proposal group max_votes %}%"></div>
                    </div>
                  </div>
                  <div class="label -infavor">{{proposal|upvotes:group}}</div>
                </div>
                <span class="balance">{{proposal|score:group}}</span>
              </div>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endfor %}

  </div>

</div>
